((self||this)["webpackJsonp@sprinklrjs/chat-web-client"]=(self||this)["webpackJsonp@sprinklrjs/chat-web-client"]||[]).push([[46],{1514:function(e,t,a){"use strict";a.r(t);var r=a(191),n=a.n(r),c=a(48),i=a.n(c),s=a(272),d=a.n(s),I=a(8),E=a.n(I),p=a(589),o=a(321);const l="CLOSED",v="TRIGGERED";var u=a(386),O=a(363),T=a(1),C=a(199),R=a(364),b=a(307);const N=e=>{switch(e){case R.a.CLOSE:case R.a.URL:case R.a.OPEN_LAST_CONVERSATION:case R.a.VIDEO_CALL:case R.a.AUDIO_CALL:return e;default:return"NEW_CONVERSATION"}},G=e=>{const{interceptId:t,creative:a,targets:n,onClose:c,settings:s,creativeId:I,variantLessInterceptId:R}=e,G=Object(T.b)(),y=(e=>{let{interceptId:t,targets:a,creativeId:n}=e;const c=Object(p.a)({targets:a,interceptId:t,creativeId:n});return Object(r.useCallback)((e=>e.type===l?c({type:o.a.CLOSE}):e.type===v?c({type:o.a.TRIGGERED}):c({type:o.a.ENGAGE,buttonId:E()(e,"button.id")})),[c])})({interceptId:t,targets:n,creativeId:I}),f=Object(O.a)(),g=Object(u.a)(),{createCase:S,disableManualResponse:_=!1}=Object(r.useMemo)((()=>d()(s)?{createCase:E()(a,"additional.createCase"),disableManualResponse:E()(a,"disableManualResponse")}:{createCase:E()(s,"liveChatCreateCase"),disableManualResponse:E()(s,"liveChatDisableManualResponse")}),[a,s]);return Object(r.useEffect)((()=>{const e=e=>{e.id===t&&y(e).catch((e=>{Object(C.b)(e)})).finally((()=>{e.type!==v&&c(t)}))};return G.sprChat("onPromptAction",e),()=>{G.sprChat("offPromptAction",e)}}),[]),Object(r.useEffect)((()=>(G.sprChat("openNewPrompt",{id:t,messages:[{text:a.text,disableManualResponse:_}],buttons:i()(a.buttons,(e=>({id:e.id,label:e.title,type:N(E()(n,[`${e.id}`,"type"])),value:E()(n,[`${e.id}`,"value"])}))),additional:{...E()(a,"additional"),createCase:S,interceptId:t,creativeId:I}}),()=>{G.sprChat("clearPrompt",{id:t})})),[t,a,n]),Object(r.useEffect)((()=>()=>{f.getActionState(R)===o.a.TRIGGERED&&g({type:b.a.INTERCEPT_AUTO_CLOSED,payload:{interceptId:t,creativeId:I}})}),[]),null};var y=n.a.memo(G),f=a(352),g=a(192);const S=e=>{let{intercepts:t,onClose:a}=e;return Object(g.jsx)(n.a.Fragment,null,i()(t,(e=>{const t=f.a.getId(e);return Object(g.jsx)(y,{key:t,interceptId:t,creativeId:f.a.getCreativeId(e),creative:f.a.getCreative(e),targets:f.a.getTargets(e),onClose:a,settings:f.a.getSettings(e),variantLessInterceptId:e.interceptId})})))};t.default=n.a.memo(S)},386:function(e,t,a){"use strict";var r=a(191),n=a(507),c=a(307);t.a=()=>{const{refetch:e}=Object(n.a)({skipQueryOnMount:!0});return Object(r.useCallback)((t=>{const{type:a,payload:r}=t;switch(a){case c.a.INTERCEPT_TRIGGERED:return e({eventType:c.a.INTERCEPT_TRIGGERED,eventId:r.interceptId,details:{creativeId:r.creativeId}});case c.a.INTERCEPT_SNOOZE_TRIGGERED:return e({eventType:c.a.INTERCEPT_SNOOZE_TRIGGERED,eventId:r.interceptId,details:{creativeId:r.creativeId}});case c.a.INTERCEPT_ENGAGED:return e({eventType:c.a.INTERCEPT_ENGAGED,eventId:r.interceptId,details:{targetId:r.targetId,creativeId:r.creativeId}});case c.a.SNOOZE:return e({eventType:c.a.SNOOZE,eventId:r.interceptId,details:{targetId:r.targetId,creativeId:r.creativeId}});case c.a.INTERCEPT_AUTO_CLOSED:return e({eventType:c.a.INTERCEPT_AUTO_CLOSED,eventId:r.interceptId,details:{creativeId:r.creativeId}});default:return e({eventType:c.a.INTERCEPT_CLOSED,eventId:r.interceptId,details:{creativeId:r.creativeId}})}}),[e])}},589:function(e,t,a){"use strict";var r=a(191),n=a(386),c=a(363),i=a(508);var s=a(307),d=a(321),I=a(364);t.a=function(e){let{targets:t,interceptId:a,creativeId:E}=e;const p=Object(n.a)(),o=Object(c.a)();return Object(r.useCallback)((e=>{const r=()=>{p({type:s.a.INTERCEPT_CLOSED,payload:{interceptId:a,creativeId:E}}),o.setAction(a,d.a.CLOSE)};return new Promise(((n,c)=>{const{type:l,buttonId:v}=e;if(l===d.a.CLOSE)return r(),void n();if(l===d.a.TRIGGERED)return p({type:s.a.INTERCEPT_TRIGGERED,payload:{interceptId:a,creativeId:E}}),o.setAction(a,d.a.TRIGGERED),void n();if(l===d.a.SNOOZE)return(e=>{p({type:s.a.SNOOZE,payload:{targetId:e,interceptId:a,creativeId:E}}),o.setAction(a,d.a.SNOOZE)})(),void n();if(l===d.a.ENGAGE){if(v){const e=((e,t)=>t&&e?t[e]:void 0)(v,t),a=e&&i.a.getType(e);if(!a)return void n();if(a===I.a.CLOSE)return r(),void n()}return(e=>{p({type:s.a.INTERCEPT_ENGAGED,payload:{targetId:e,interceptId:a,creativeId:E}}),o.setAction(a,d.a.ENGAGE)})(v),void n()}n()}))}),[p,t,a])}}}]);